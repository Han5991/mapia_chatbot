<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}">
    <script src="https://code.jquery.com/jquery-1.8.3.min.js"
            integrity="sha256-YcbK69I5IXQftf/mYD8WY0/KmEDCv1asggHpJk1trM8=" crossorigin="anonymous"></script>
    <script href="{{ url_for('static', filename='js/chat.js') }}">
        $(function () {
            $("input[type='text']").keypress(function (e) {
                //f()
                if (e.keyCode == 13 && $(this).val().length) {
                    let _val = $(this).val();
                    let _class = $(this).attr("class");
                    $(this).val('');
                    $(".chat_wrap .inner").append('<div class="item ' + _class + '"><div class="box"><p class="msg">' + _val + '</p><span class="time">' + currentTime() + '</span></div></div>');

                    let lastItem = $(".chat_wrap .inner").find(".item:last");
                    setTimeout(function () {
                        lastItem.addClass("on");
                    }, 10);
                    let position = lastItem.position().top + $(".chat_wrap .inner").scrollTop();
                    $(".chat_wrap .inner").stop().animate({scrollTop: position}, 500);
                }
            });
        });

        let currentTime = function () {
            let date = new Date();
            let hh = date.getHours();
            let mm = date.getMinutes();
            let apm = hh > 12 ? "오후" : "오전";
            return apm + " " + hh + ":" + mm + "";
        }

        function f() {
            fetch("http://127.0.0.1:5000/input", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    input: $("input[type='text']").val()
                }),
            }).then((response) => console.log(response));
        }

    </script>
</head>
<body>
<div class="chat_wrap">
    <div class="inner"></div>
    <input type="text" class="mymsg" placeholder="내용 입력">
    <input type="text" class="yourmsg" placeholder="내용 입력">
</div>
</body>
</html>